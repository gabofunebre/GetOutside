<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Movimientos de Dinero</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="/static/css/style.css" />
</head>
<body>
  <div class="container mt-5">
    <h2 class="mb-4 text-center">Movimientos de Dinero</h2>

    <div class="d-flex justify-content-between align-items-center">
      <button type="button" class="btn btn-filtro btn-sm" id="btnFiltro">Filtrar</button>
      <a href="/tenencias/" class="btn btn-primary btn-modern">Ir a Tenencias</a>
    </div>
    <p id="infoConsulta" class="small text-muted mt-2 mb-3">Últimos 30 movimientos de dinero</p>
    <div class="tabla-scroll">
      <table class="table table-striped tabla-ordenable align-middle" id="tabla-movimientos">
        <thead>
          <tr>
            <th class="col-fecha" data-key="fecha">Fecha</th>
            <th class="col-concepto" data-key="concepto">Concepto</th>
            <th class="col-moneda d-none d-md-table-cell" data-key="moneda">Moneda</th>
            <th class="col-importe" data-key="importe">Importe</th>
          </tr>
        </thead>
        <tbody id="tabla-body">
          <!-- Se insertan dinámicamente -->
        </tbody>
      </table>
    </div>
  <div class="text-center mt-4">
    <a href="/" class="text-muted">&larr; Volver al Dashboard</a>
  </div>
</div>

<!-- Modal Filtro -->
<div class="modal fade" id="modalFiltro" tabindex="-1" aria-labelledby="modalFiltroLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div id="filtroOverlay" class="modal-overlay">
        <div class="spinner-border text-primary" role="status"></div>
      </div>
      <div class="modal-header">
        <h5 class="modal-title" id="modalFiltroLabel">Filtrar Movimientos</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
      </div>
      <form id="filtroForm">
        <div class="modal-body">
          <div class="d-flex justify-content-center gap-2 mb-3">
            <button type="button" class="btn btn-outline-primary btn-sm" id="btnSemana">Última semana</button>
            <button type="button" class="btn btn-outline-primary btn-sm" id="btnMes">Último mes</button>
          </div>
          <div class="row g-2 mb-3">
            <div class="col">
              <label for="fechaDesde" class="form-label">Fecha desde</label>
              <input type="date" class="form-control" id="fechaDesde">
            </div>
            <div class="col">
              <label for="fechaHasta" class="form-label">Fecha hasta</label>
              <input type="date" class="form-control" id="fechaHasta">
            </div>
          </div>
          <div class="mb-3">
            <label for="tipoFiltro" class="form-label">Tipo</label>
            <select id="tipoFiltro" class="form-select">
              <option value="">Todos</option>
              <option value="INGRESO">Ingresos</option>
              <option value="EGRESO">Egresos</option>
              <option value="VENTA">Ventas</option>
            </select>
          </div>
          <div class="mb-3">
            <label for="conceptoBuscar" class="form-label">Concepto</label>
            <input type="text" class="form-control" id="conceptoBuscar" placeholder="Buscar concepto">
          </div>
        </div>
        <div class="modal-footer">
          <button type="submit" class="btn btn-primary">Aplicar</button>
        </div>
      </form>
    </div>
  </div>
</div>


  
  <!-- Modal Detalle de Movimiento -->
  <div class="modal fade" id="modalMovimiento" tabindex="-1" aria-labelledby="modalMovimientoLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content rounded-4 shadow-sm border-0">
        <div class="modal-header bg-primary text-white rounded-top-4">
          <h5 class="modal-title" id="modalMovimientoLabel">Detalle del Movimiento</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Cerrar"></button>
        </div>
        <div class="modal-body p-4" id="modalMovimientoBody">
          <div class="text-center text-muted">Cargando...</div>
        </div>
      </div>
    </div>
  </div>
  <!-- Bootstrap Bundle con JS (incluye Modal, Tooltip, etc.) -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://unpkg.com/tablesort@5.3.0/dist/tablesort.min.js"></script>
  <script src="/static/js/movimientosDinero.js"></script>
</body>
</html>
